DBDBDB

-- 상품 테이블(PK, UNIQUE(이름), 가격, 규격, 공급자, 주의사항)
CREATE TABLE supply(
	SUPPLY_NUM INT PRIMARY KEY AUTO_INCREMENT NOT NULL
	, SUPPLY_NAME VARCHAR(30) UNIQUE NOT NULL
	, SUPPLY_PRICE INT NOT NULL
	, SUPPLY_STANDARD VARCHAR(50) NOT NULL
	, SUPPLIER VARCHAR(50) NOT NULL
	, SUPPLY_CAUTION VARCHAR(50) NOT NULL
)

-- 상품 상세 테이블(PK, FK(상품 번호), 입고 날짜, 입고량)
CREATE TABLE contract(
	CONTRACT_NUM INT PRIMARY KEY AUTO_INCREMENT NOT NULL
	, SUPPLY_NUM INT REFERENCES supply(SUPPLY_NUM) NOT NULL
	, CONTRACT_DATE DATETIME NOT NULL
	, CONTRACT_AMOUNT INT NOT NULL
	, CONTRACT_OUTPUT INT 
)

-- 주문 상세 테이블(PK, FK(주문 번호), FK(상품 번호), 주문된 상품 수,) 
CREATE TABLE DETAIL_ORDER_FORM(
	DETAIL_ORDER_NUM INT PRIMARY KEY AUTO_INCREMENT NOT NULL
	, ORDER_NUM INT NOT NULL REFERENCES order_form(ORDER_NUM) ON DELETE CASCADE
	, SUPPLY_NUM INT NOT NULL REFERENCES supply(SUPPLY_NUM) ON DELETE CASCADE
	, ORDER_AMOUNT INT NOT NULL
	, TOTAL_PRICE INT 
)


-- 주문 테이블(PK, FK(고객 번호), 주문 처리 상태, 총 주문 금액, 주문 날짜, 주문 처리자)
CREATE TABLE order_form(
	ORDER_NUM INT PRIMARY KEY AUTO_INCREMENT NOT NULL
	, CUSTOMER_NUM INT NOT NULL REFERENCES customer(CUSTOMER_NUM) ON DELETE CASCADE
	, ORDER_STATUS VARCHAR(50) DEFAULT 'NONE'
	, TOTAL_AMOUNT INT 
	, ORDER_DATE VARCHAR(50) NOT NULL
	, ORDER_MANAGER VARCHAR(50) NOT NULL
)

-- 처리된 주문서 테이블(PK, FK(주문번호), 처리날짜, 처리자)
CREATE TABLE done_form(
	DONE_NUM INT PRIMARY KEY AUTO_INCREMENT NOT NULL
	, ORDER_NUM INT NOT NULL REFERENCES order_form(ORDER_NUM) ON DELETE CASCADE
	, DONE_DATE DATETIME DEFAULT CURRENT_TIMESTAMP
	, DONE_MANAGER VARCHAR(50) NOT NULL
)

-- 상품 테이블(PK, 이름, 가격, 상품 규격, 공급자, 주의사항)
CREATE TABLE supply(
	SUPPLY_NUM INT PRIMARY KEY AUTO_INCREMENT NOT NULL
	, SUPPLY_NAME VARCHAR(50) UNIQUE NOT NULL
	, SUPPLY_STANDARD VARCHAR(50) NOT NULL
	, SUPPLIER VARCHAR(50) NOT NULL
	, SUPPLY_CAUTION VARCHAR(50) 
)

-- 재고가 부족한 상품을 담을 테이블(PK, FK(상품번호), 얼마나 부족한지 담을 변수)
CREATE TABLE NEED_FORM(
	NEED_NUM INT PRIMARY KEY AUTO_INCREMENT NOT NULL
	, SUPPLY_NUM INT REFERENCES supply(SUPPLY_NUM) ON DELETE CASCADE
	, NEED_CNT INT NOT NULL
)

-- 추가 요청한 상품을 담을 테이블(PK, FK(상품번호), 배송 소요 기간(일단위))
CREATE TABLE PLUS_FORM(
	PLUS_NUM INT PRIMARY KEY AUTO_INCREMENT NOT NULL
	, SUPPLY_NUM INT REFERENCES supply(SUPPLY_NUM) ON DELETE CASCADE
	, DUE_DATE DATETIME NOT NULL
)


INSERT INTO order_form
(CUSTOMER_NUM
, ORDER_DATE
, ORDER_MANAGER)
VALUES
(4
, '2024-01-30'
, '2루'
)

INSERT INTO detail_order_form
(ORDER_NUM
, SUPPLY_NUM
, ORDER_AMOUNT
)
VALUES
(13
, 1
, 450
)

INSERT INTO detail_order_form
(ORDER_NUM
, SUPPLY_NUM
, ORDER_AMOUNT
)
VALUES
(12
, 2
, 60
)


SELECT * FROM DETAIL_ORDER_FORM
